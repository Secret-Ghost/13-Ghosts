                                                                                    +------------------------------------------------+
                                                                                    |                                                |
                                                                                    |                                                |
                                                                                    |                                                |
                                                                                    |                                                |
                                                                           +--------v---------+                                      |
                                                                           |       Nmap       +-----------+                          |
                                                                           +------------------+           |                          |
                                                                                                          |                          |
                                                                                                          |                          |
                                                                           +------------------+           |                          |
                                                                           |    Nmap results  | <---------+                          |
                                                                           +---------+--------+                                      |
                                                                                     |                                               |
                                                                           +---------v--------+                                      |
                                                            +--------------+     tcp open?    +--------------+                       |
                                                            |              +------------------+              |                       |
                                                            |                                                |                       |
                                                            |                                                |                       |
                                                            |                                                |                       |
                                                            |                                                |                       |
                                                            |                                                |                       |
                                                            |                                                |                       |
                                                            |                                                |                       |
                                                            |                                                |                       |
                                                            v                                                v                       |
                                                    +-------+---------+                             +--------+--------+              |
                                                    |                 |                             |                 |              |
                                                    | Success Shares  |                             |   Nmap did not  |              |
                                                    |   Available     |                             | find any shares |              |
                                                    |                 |                             |    try again :) |              |
                                                    +-------+---------+                             +--------+--------+              |
                                                            |                                                |                       |
                                                            |                                                |                       |
                                                            |                                                |                       |
                                                            |                                                |                       |
                                                            |                                                +-----------------------+
                                                            |             +----------------------+ +-------------------------------------------------------------------------------------------+
                                                            +---------->  | nmblookup each ip    <------------------------------------------------------------------------------+              |
                                                                          |  in nmap results     | <----------------+                                                           |              |
+-----------------------------------------------------------------------> +---+------+-----------+                  |                                                           |              |
|                                                                             ^      |                              |                                                           |              |
|               +-------------------------------------------------------------+      |                              |                                                           |              |
|               |                                                                    |                              |                                                           |              |
|               |                                                         +----------v------------+                 |                                                           |              |
|               |                                                         | Includes Mac Address  |                 |                                                           |              |
|               |                                  +----------------------+ True            False +-----------------+-                                                          |              |
|               |                                  |                      +-----------------------+                                                                             |              |
|               |                                  |                                                                                                                            |              |
|               |                                  |                                                                                                                            |              |
|               |                                  |                                                                                                                            |              |
|               |                                  |                                                                                                                            |              |
|               |                                  |                                                                                                                            |              |
|               |                                  |                                                                                                                            |              |
|               |                                  |                                                                                                                            |              |
|               |                                  |                                                                                                                            |              |
|               |                +-----------------v-------------------++                                                                                                       |              |
|               |                |                                     |                                                                                                        |              |
|               |                |  output nmblookup results to file   |                                                                                                        |              |
|               |                |  print result to terminal           |                                                                                                        |              |
|               |                |                                     |                                                                                                        |              |
|               +----------------+  False    Investigate?   True       |                                                                                                        |              |
|                                |                                     |                                                                                                        |              |
|                                +---------------------------+---------+                                                                                                        |              |
|                                                            |                                                                                                                  |              |
|                                                            |                                                                                                                  |              |
|                                                            |                                                                                                                  |              |
|                                                            |                                                                                                                  |              |
|                                                            |                                                                                                                  |              |
|                                                            |                                                                                                                  |              |
|                                                            |                                              +---------------------------------------------+                     |              |
|                                                            |                                              |           Grab all share names              |                     |              |
|                                                            |                                              |          print share share names            |                     |              |
|                                                            |                                              |                                      SKIP   +---------------------+              |
|                                                            +----------------------------------------------->                                            |                                    |
|                                                                                                           |                                             |                                    |
|                                                                                                           |                                             |                                    |
|                                                                                                           |  Select Share                               |                                    |
|                                                                                                           +------+--------------------------------------+                                    |
|                                                                                                                  |                                                                           |
|                                                                                                                  |                                                                           |
|                                                                                                                  |                                                                           |
|                                                                                                                  |                                                                           |
|                                                                                                +-----------------+-----------------+                                                         |
|                                                                                                | smbclient -L list sub shares in   |                                                         |
|                                                                                                | selected share                    |                                                         |
|                                                                                                |                                   |                                                         |
|                                                                                                +-----------------+-----------------+                                                         |
|                                                                                                                  |                                                                           |
|                                                                                                                  |                                                                           |
|                                                                                                                  |                                                                           |
|                                                                                                                  |                                                                           |
|                                              +--------------------------------+                                  |                                                                           |
|                                              |     Smbclient -L result        |                                  |                                                                           |
|                                              |        include failed?         +----------------------------------+                                                                           |
|                                              | True                     F+lse |                                                                                                              |
|                                              +---+----------------------------+                                                                                                              |
|                                                  |                       |                                                                                                                   |
|                                                  |                       |                                                                                                                   |
|                                                  |                       |                                                                                                                   |
|                                                  |                       |                                                                                                                   |
|                                                  |                       |                                                                                                                   |
|                                                  |                       +-------------------------------------------------------------------------------------------------------------------+
|                                                  |
|                                                  |
|                                                  |
|                                                  |
|                                                  |
|                                                  |                              +------------------------------------+
|                                                  |                              | print sub shares                   |
|                                                  +------------------------------+ Select sub share to mount          |
|                                                                                 |                                    |
|                                                                                 | smbclient // share + / + subshare  |
|                                                                                 +----------------+---+---+-----------+
|                                                                                                  |
|                                                                                                  |
|                                                                                 +----------------v-------------------+
|                                                                                 |             Success?               |
|                                                                                 |                                    |
|                                                                                 |                                    |
|                                                                    +----------+ |True                         False  |
|                                                                    |            +-------------------------------+----+
|                                                                    |                                            |
|                                                                    |                                            |
|                                                                    |                                            |
|                                                                    |                                            |
|                                                          +---------v---------+                                  |
|                                                          |                   |                                  |
|                                                          |   Drop into smb   |                                  |
|                                                          |                   |                                  |
|                                                          +-------------------+                                  |
|                                                                                                                 |
|                                                                                                                 |
|                                                                                                                 |
|                                                                                                                 |
|                                                                                                                 |
+-----------------------------------------------------------------------------------------------------------------+
